(library
 (name tests)
 (public_name mlir.tests)
 (libraries mlir)
 (inline_tests)
 (preprocess
  (pps ppx_expect ppx_inline_test))
 (flags
  (:standard -cclib %{read:mlir_flags})))

(rule
 (targets mlir_flags)
 (action
  (bash "echo \"-Wl,-rpath,`llvm-config-16 --libdir`\" > mlir_flags")))
